% vim: set spell spelllang=en tw=100 :

\documentclass[letterpaper]{article}

\include{preamble}

\title{Between Subgraph Isomorphism and Maximum Common Subgraph}

\author{Ruth Hoffmann \and Ciaran McCreesh\thanks{This work was supported by the Engineering and Physical Sciences
Research Council [grant number EP/K503058/1]} \and Craig Reilly \\
University of Glasgow, Glasgow, Scotland \\
ruth.hoffmann@glasgow.ac.uk \and \{c.mccreesh.1,c.reilly.2\}@research.gla.ac.uk}

\pdfinfo{
    /Title (Between Subgraph Isomorphism and Maximum Common Subgraph)
    /Author (Ruth Hoffmann and Ciaran McCreesh and Craig Reilly)
}

\begin{document}

\maketitle

\begin{abstract}
    When a small pattern graph does not occur inside a larger target graph, we can ask how to find
    ``as much of the pattern as possible'' inside the target graph. In general, this is maximum
    common subgraph problem, which is much more computationally challenging in practice than
    subgraph isomorphism. We present and evaluate a new constraint-style algorithm which lies
    between these two approaches, for cases when nearly all of the pattern is present.
\end{abstract}

\section{Introduction}

The subgraph isomorphism problem is to find a copy of a small \emph{pattern} graph inside a larger
\emph{target} graph. It comes in two forms: in the non-induced variant, edges must be mapped to
edges, but the target may have ``extra edges'', whilst in the induced variant, non-edges may only be
mapped to non-edges. When a pattern cannot be found, we may wish to be given a result which maps as
many vertices of the pattern into the target as possible. In the induced case, this is known as the
maximum common induced subgraph problem (we discuss the non-induced case below). However, although
recent subgraph isomorphism algorithms are comfortable working with graphs with thousands of
vertices, the state of the art for the maximum common subgraph problem becomes computationally
infeasible at only 35 vertices when working with unlabelled graphs \citep{CP2016MCSPaper}. This is
largely because strong inference, based upon the degrees of vertices
\citep{DBLP:journals/ai/Solnon10} and the distances or paths between them
\citep{DBLP:conf/cp/AudemardLMGP14,DBLP:conf/cp/McCreeshP15}, is possible with subgraph isomorphism,
but not maximum common subgraph, and so the state space in the former is much more restricted. In
this work we discuss an intermediate problem, where we must map all but $k$ vertices of the pattern
graph into the target. We show that if $k$ is reasonably small (say, between 1 and 5), then weakened
forms of degree and path based filterings are still effective in pruning the search space and
providing additional constraints respectively. We then show that combining these techniques does
lead to a practical algorithm which can scale to work with the families of graphs commonly used to
benchmark subgraph isomorphism algorithms.

\subsection{Definitions and Notations}

A non-induced subgraph isomorphism from a graph $P$ to a graph $T$ is an injective mapping
$P \rightarrowtail T $ which maps adjacent vertices to adjacent vertices. An induced subgraph
isomorphism $P \hookrightarrow T$, additionally maps non-adjacent vertices to non-adjacent
 vertices.

A common induced subgraph of graphs $G$ and $H$ is a graph $P$, together with two induced subgraph
isomorphisms to $G$ and $H$; a maximum common induced subgraph is a common induced subgraph with as
many vertices as possible.

A maximum common partial (i.e.\ non-induced) subgraph would allow us to select every vertex in the
pattern, and none of the edges. The objective is therefore changed to maximise the number of edges,
rather than vertices. However, this is not what we are looking for: usually maximum common subgraph
problems are symmetric in their inputs, but we are allowing extra edges only in the target, not in
the pattern.

We define a $k$-less-subgraph isomorphism from $P$ to $T$ to be a subgraph isomorphism from all
but $k$ vertices of $P$ to $T$; this may be non-induced or induced, written
$P \lessnonind{k} T$ and $P \lessind{k} T$ respectively.

\subsection{Models and Algorithms}

\subsection{Experimental Setup}

\section{Domain Filtering}

A non-induced $k$-less-subgraph isomorphism from $P$ to $T$ is equivalent to a subgraph
isomorphism between $P$ and $T$ with $k$ extra universally-adjacent vertices. (However, we can do a
bit better algorithmically.) For induced $k$-less-subgraph isomorphisms, such an approach cannot
work.

Let $S$ and $T$ be two sequences. We define $S \preceq T$

\todo{Define $\preceq$, deg, nds}

\begin{proposition}
    Let $p$ be a vertex in $P$ and $t$ a vertex in $T$. For both non-induced and induced
    $k$-less-subgraph isomorphisms, if $p \prescript{}{k}{\mapsto} t$ then
    $\deg(p) - k \le \deg(t)$.
\end{proposition}
\begin{proof}
Let $p$ be a vertex in $P$, and $t$ a vertex in $T$, with $p\mapsto t$. Then by the definition of subgraph isomorphisms, $\deg(p) \le \deg(t)$. Let $P'$ be $P$ less $k$ vertices and $p$ a vertex in $P'$. Then
\[
\deg_{P}(p)-k \le \deg_{P'}(p) \le \deg_{P}(p) \le \deg(t).
\]
\end{proof}

\begin{proposition}
    More powerfully, if $p \prescript{}{k}{\mapsto} t$ then
    $(\nds(p)[k+1] - k, \nds(p)[k+2] - k, \ldots) \preceq \nds(t)$.
\end{proposition}

\begin{proof}
Let

\end{proof}

\section{Filtering During Search}

As well as reasoning about degrees, we can also reason about paths.

\todo{Define paths}

\begin{proposition}
    If $p \prescript{}{k}{\mapsto} t$ and $q \prescript{}{k}{\mapsto} u$ then
     $\operatorname{paths}(p, q, 2) \le \operatorname{paths}(t, u, 2) + k$.
\end{proposition}

This leads to the following:

\begin{proposition}
    For a graph $G$, let $G^{n, \ell}$ be the graph with vertex set $\operatorname{V}(G)$. The
    vertices $p$ and $q$ in $G^{n, \ell}$ are adjacent, if there are at least $n$ simple paths of
    length exactly $\ell$ between $p$ and $q$ in $G$. Then any $k$-less-subgraph isomorphism
    $P \lessnonind{k} T$ induces a new $k$-less-subgraph isomorphism
    $P^{n, 2}\lessnonind{k} T^{n - k, 2}$.
\end{proposition}

\section{A New Algorithm}

\section{Empirical Evaluation}

\subsection{Induced}

Comparison with the clique and CP models, as well as ``drop k vertices and try each in turn''.

\subsection{Non-Induced}

Just results and ``drop k vertices and try each in turn''.

\subsection{Parallel Search}

\section{Conclusion}

\section*{Acknowledgements}

We're not going to thank anyone, no, no.

\bibliographystyle{named}
\bibliography{paper}

\end{document}

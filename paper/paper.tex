% vim: set spell spelllang=en tw=100 :

\documentclass[letterpaper]{article}
\usepackage[pass]{geometry}

\usepackage{ijcai16}
\usepackage{times}
\usepackage{complexity}
\usepackage{microtype}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{cleveref}
\usepackage{tikz}

\usetikzlibrary{decorations, decorations.pathreplacing, calc, backgrounds}

\definecolor{uofgsandstone}{rgb}{0.321569, 0.278431, 0.231373}
\definecolor{uofglawn}{rgb}{0.517647, 0.741176, 0}
\definecolor{uofgcobalt}{rgb}{0, 0.615686, 0.92549}
\definecolor{uofgpumpkin}{rgb}{1.0, 0.72549, 0.282353}
\definecolor{uofgthistle}{rgb}{0.584314, 0.070588, 0.447059}

\newcommand{\citet}[1]{\citeauthor{#1} \shortcite{#1}}
\newcommand{\citep}[1]{\cite{#1}}

\theoremstyle{definition}
\newtheorem{proposition}{Proposition}

% cref style
\crefname{figure}{Figure}{Figures}
\Crefname{figure}{Figure}{Figures}

% http://tex.stackexchange.com/questions/22100/the-bar-and-overline-commands
\newcommand{\shortoverline}[1]{\mkern 1.5mu\overline{\mkern-1.5mu#1\mkern-1.5mu}\mkern 1.5mu}

%to do comments
\usepackage{color}
\newcommand{\todo}[1]{{\color{red} {[}{#1}{]}}}

\title{Between Subgraph Isomorphism and Maximum Common Subgraph}

\author{Ruth Hoffmann \and Ciaran McCreesh\thanks{This work was supported by the Engineering and Physical Sciences
    Research Council [grant number EP/K503058/1]} \\
University of Glasgow, Glasgow, Scotland \\
ruth.hoffmann@glasgow.ac.uk \and c.mccreesh.1@research.gla.ac.uk}

\pdfinfo{
    /Title (Between Subgraph Isomorphism and Maximum Common Subgraph)
    /Author (Ruth Hoffmann and Ciaran McCreesh)
}

\begin{document}

\maketitle

\begin{abstract}
    When a small pattern graph does not occur inside a larger target graph, we can ask how to find
    ``as much of the pattern as possible'' inside the target graph. In general, this is maximum
    common subgraph problem, which is much more computationally challenging in practice than
    subgraph isomorphism. We present and evaluate a new constraint-style algorithm which lies
    between these two approaches, for cases when nearly all of the pattern is present.
\end{abstract}

\section{Introduction}

The subgraph isomorphism problem is to find a copy of a small \emph{pattern} graph inside a larger
\emph{target} graph. It comes in two forms: in the non-induced variant, edges must be mapped to
edges, but the target may have ``extra edges'', whilst in the induced variant, non-edges may only be
mapped to non-edges. When a pattern cannot be found, we may wish to be given a result which maps as
many vertices of the pattern into the target as possible. In the induced case, this is known as the
maximum common induced subgraph problem (we discuss the non-induced case below). However, although
recent subgraph isomorphism algorithms are comfortable working with graphs with thousands of
vertices, the state of the art for the maximum common subgraph problem becomes computationally
infeasible at only 35 vertices when working with unlabelled graphs \citep{CP2016MCSPaper}. This is
largely because strong inference, based upon the degrees of vertices
\citep{DBLP:journals/ai/Solnon10} and the distances between them
\citep{DBLP:conf/cp/AudemardLMGP14,DBLP:conf/cp/McCreeshP15}, is possible with subgraph isomorphism,
but not maximum common subgraph, and so the state space in the former is much more restricted. In
this work we discuss an intermediate problem, where we must map all but $k$ vertices of the pattern
graph into the target. We then present and evaluate an algorithm which, when $k$ is small (say,
between 1 and 3) is much more scaleable than general maximum common subgraph algorithms.

\section{Some Maths}
A non-induced subgraph isomorphism from a graph $P$ to a graph $T$ is an injective mapping
$i: P \rightarrowtail T $ which maps adjacent vertices to adjacent vertices. An induced subgraph
isomorphism $i: P \hookrightarrow T$, additionally maps non-adjacent vertices to non-adjacent
 vertices.

A common induced subgraph of graphs $G$ and $H$ is a graph $P$, together with two induced subgraph
isomorphisms to $G$ and $H$; a maximum common induced subgraph is a common induced subgraph with as
many vertices as possible.

A maximum common partial (i.e.\ non-induced) subgraph would allow us to select every vertex in the
pattern, and none of the edges. The objective is therefore changed to maximise the number of edges,
rather than vertices. However, this is not what we are looking for: usually maximum common subgraph
problems are symmetric in their inputs, but we are allowing extra edges only in the target, not in
the pattern.

We define a subgraph-except-$k$ isomorphism from $P$ to $T$ to be a subgraph isomorphism from all
but $k$ vertices of $P$ to $T$; this may be non-induced or induced, written
$i_{k}: P \rightarrowtail T$ and $i_{k}: P \hookrightarrow T$ respectively.

A non-induced subgraph-except-$k$ isomorphism from $P$ to $T$ is equivalent to a subgraph
isomorphism between $P$ and $T$ with $k$ extra universally-adjacent vertices. (However, we can do a
bit better algorithmically.) For induced subgraph-except-$k$ isomorphisms, such an approach cannot
work.


\todo{Define $\preceq$, deg, nds, paths}

\begin{proposition}
    Let $p$ be a vertex of $P$ and $t$ a vertex in $T$. For both non-induced and induced
    subgraph-except-$k$ isomorphisms, if $i_{k}(p) = t$ then
    $\operatorname{deg}(p) \le \operatorname{deg}(t) + k$.
\end{proposition}

\begin{proposition}
    More powerfully, if $i_{k}(p) = t$ then $\operatorname{nds}(p)[k, k+1, \ldots] \preceq
    \operatorname{nds}(t)$.
\end{proposition}

As well as reasoning about degrees, we can also reason about paths.

\begin{proposition}
    If $i_{k}(p) = t$ and $i_{k}(q) = u$ then $\operatorname{paths}(p, q, 2) \le
    \operatorname{paths}(t, u, 2) + k$.
\end{proposition}

This leads to the following:

\begin{proposition}
    For a graph $G$, let $G^{n, \ell}$ be the graph with vertex set $\operatorname{V}(G)$, and
    and $p,q\in\operatorname{V}(G)$, with $p$ and $q$ adjacent if there are at least $n$
    simple paths of length exactly $\ell$ between $p$ and $q$ in $G$. Then any subgraph-except-$k$
    isomorphism $i_{k}: P \rightarrowtail T$ induces a new subgraph-except-$k$ isomorphism
    $i^{n, 2}_{k} : P^{n, 2}\rightarrowtail T^{n - k, 2}$.
\end{proposition}

\section{An Algorithm}

\section{Empirical Evaluation}

\section{Conclusion}

\section*{Acknowledgements}

We're not going to thank anyone, no, no.

\bibliographystyle{named}
\bibliography{paper}

\end{document}
